import{r as t,h as e,c as s}from"./p-df6a2f70.js";function i(t){const e=t.indexOf("R"),s=t.indexOf("G"),i=t.indexOf("B");if(e<0||s<0||i<0)return;const r=t.substring(e+1,e+4),h=t.substring(s+1,s+4),n=t.substring(i+1,i+4);try{return new a(parseInt(r),parseInt(h),parseInt(n))}catch(t){console.error(t)}return null}class r{constructor(){this.width=100,this.height=100,this.color=null,this.shape="bar"}init(t){t.forEach(t=>{t.toUpperCase().startsWith("HEIGHT;")?this.initHeight(t):t.toUpperCase().startsWith("SHAPE;")?this.initShape(t):t.toUpperCase().startsWith("BCOLOR;")||this.initColor(t)})}initColor(t){if(t.length>11&&this.isValidColor(t)){this.color=i(t.substring(0,12));try{this.width=parseFloat(t.substring(13).replace(",","."))}catch(t){console.error(t)}}else if(t.startsWith("*NONE"))try{this.width=parseFloat(t.substring(6).replace(",","."))}catch(t){console.error(t)}}isTrasparent(){return null===this.color}initHeight(t){if(t){const e=t.substring("HEIGHT;".length).replace(",",".");try{this.height=parseFloat(e)}catch(t){console.error(t)}}}initShape(t){const e=(t=t.substring("SHAPE;".length)).indexOf(";");let s=t;if(e>-1){s=t.substring(0,e);try{this.width=parseFloat(t.substring(e+1).replace(",","."))}catch(t){console.error(t)}}switch(s.toLocaleLowerCase()){case"circle":this.shape="circle";break;case"tril":this.shape="tril";break;case"trir":this.shape="trir"}}isValidColor(t){if(!t)return!1;const e=[];let s=!1,i=null,r=(t=t.trim()).indexOf("R");if(r>-1&&(i=t.substring(r+1,r+4),e[0]=parseInt(i),isNaN(e[0])&&(s=!0)),(r=t.indexOf("G"))>-1&&(i=t.substring(r+1,r+4),e[1]=parseInt(i),isNaN(e[1])&&(s=!0)),(r=t.indexOf("B"))>-1&&(i=t.substring(r+1,r+4),e[2]=parseInt(i),isNaN(e[2])&&(s=!0)),s){const r=t.indexOf("R"),a=t.indexOf("G"),h=t.indexOf("B");if(i=t.substring(r+1,a),e[0]=parseInt(i),isNaN(e[0])&&(s=!0),i=t.substring(a+1,h),e[1]=parseInt(i),isNaN(e[1])&&(s=!0),i=t.substring(h+1),e[2]=parseInt(i),isNaN(e[2])&&(s=!0),s)return!1}return!(e[0]<0||e[0]>255||e[1]<0||e[1]>255||e[2]<0||e[2]>255)}getHeight(){return this.height}getWidth(){return this.width}getShape(){return this.shape}getColor(){return this.color}}class a{constructor(t,e,s){this.r=t,this.g=e,this.b=s}toString(){return`rgb(${this.r},${this.g},${this.b})`}}class h{constructor(e){t(this,e),this.height=30,this.width=300,this.graphic_element_marker_splitter="\\\\",this.graphic_element_splitter="\\\\AND\\\\",this.background_color="BCOLOR;R255G000B000",this.default_color=new a(0,0,0)}onValueChange(){this.draw()}componentDidLoad(){this.draw()}draw(){this.value&&this.canvas.getContext&&(this.ctx=this.canvas.getContext("2d"),this.drawGraphicCell())}drawGraphicCell(){this.value.split(this.graphic_element_splitter).forEach((t,e)=>{let s="SHAPE;BAR",a=this.background_color,h="HEIGHT;100";const n=t.split(this.graphic_element_marker_splitter),o=[],c=[];n.forEach(t=>{this.isShapeMarker(t)?s=t:this.isBgColorMarker(t)?a=t:this.isHeightMarker(t)?h=t:this.isDecoratorMarker(t)?c.push(t):o.push(t)});const l=o.map(t=>{const e=new r;return e.init([s,a,h,t]),e});if(0===e&&a!==this.background_color){const t=i(a.substring("BCOLOR;".length));this.drawRect(0,0,this.canvas.width,this.canvas.height,t)}let g=0;l.forEach(t=>{switch(t.getShape()){case"circle":g=this.getNewStarXFromCircle(g,t);break;case"tril":g=this.getNewStarXFromTril(g,t);break;case"trir":g=this.getNewStarXFromTrir(g,t);break;default:g=this.getNewStarXFromBar(g,t)}}),c.forEach(t=>{t.startsWith("SEP")||t.startsWith("DIV")?this.drawSeparator(t):t.startsWith("ARW")?this.drawArrow(t):t.startsWith("GRID")&&this.drawGrid(t)})})}isShapeMarker(t){return t&&t.toUpperCase().startsWith("SHAPE;")}isBgColorMarker(t){return t&&t.toUpperCase().startsWith("BCOLOR;")}isHeightMarker(t){return t&&t.toUpperCase().startsWith("HEIGHT;")}isDecoratorMarker(t){return t&&(t.toUpperCase().startsWith("SEP;")||t.toUpperCase().startsWith("DIV;")||t.toUpperCase().startsWith("ARW;")||t.toUpperCase().startsWith("GRID;"))}getDim(t,e){return Math.floor(t/100*e)}getNewStarXFromBar(t,e){const s=this.getDim(this.canvas.width,e.getWidth()),i=this.getDim(this.canvas.height,e.getHeight()),r=this.canvas.height-i;return e.isTrasparent()||this.drawRect(t,r,s,i,e.getColor()),s}getNewStarXFromCircle(t,e){const s=this.getDim(this.canvas.width,e.getWidth()),i=(t+s)/2;return e.isTrasparent()||this.drawArc(i,this.canvas.height/2,e.getColor()),s}getNewStarXFromTril(t,e){const s=this.getDim(this.canvas.width,e.getWidth());return e.isTrasparent()||this.drawTri(s,0,t,this.canvas.height/2,e.getColor()),s}getNewStarXFromTrir(t,e){const s=this.getDim(this.canvas.width,e.getWidth());return e.isTrasparent()||this.drawTri(t,0,s,this.canvas.height/2,e.getColor()),s}drawArc(t,e,s){this.ctx.fillStyle=s.toString(),this.ctx.beginPath(),this.ctx.arc(t,e,e,0,2*Math.PI,!0),this.ctx.fill()}drawRect(t,e,s,i,r){this.ctx.fillStyle=r.toString(),this.ctx.fillRect(t,e,s,i)}drawTri(t,e,s,i,r){this.ctx.fillStyle=r.toString(),this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.lineTo(s,i),this.ctx.lineTo(t,this.canvas.height),this.ctx.fill()}drawArrow(t){let e=t.substring("ARW;".length);e.indexOf(",")>-1&&(e=e.replace(",",".")),this.ctx.fillStyle=this.default_color.toString();const s=this.getDim(this.canvas.width,parseFloat(e)),i=this.canvas.height,r=Math.floor(i/3),a=r/2;this.ctx.beginPath(),this.ctx.moveTo(s,0),this.ctx.lineTo(s-r,i/2),this.ctx.lineTo(s-a,i/2),this.ctx.lineTo(s-a,i),this.ctx.lineTo(s+a,i),this.ctx.lineTo(s+a,i/2),this.ctx.lineTo(s+r,i/2),this.ctx.fill()}drawGrid(t){let e=t.substring("GRID;".length);e.indexOf(",")>-1&&(e=e.replace(",","."));const s=parseInt(e),i=this.canvas.width/s,r=this.canvas.height/5,a=this.canvas.height-r;for(let t=i;t<this.canvas.width;t+=i)this.drawRect(t,a,1,r,this.default_color)}drawSeparator(t){const e=t.substring("SEP;".length).split(";");let s="R000G000B000",r=2,a=e[0];e.length>1&&(s=e[1]),e.length>2&&(r=parseInt(e[2])),a.indexOf(",")>-1&&(a=a.replace(",","."));const h=this.getDim(this.canvas.width,parseFloat(a));this.drawRect(h,0,r,this.canvas.height,i(s))}render(){return e("canvas",{ref:t=>this.canvas=t,height:this.height,width:this.width},this.value)}static get watchers(){return{value:["onValueChange"]}}}class n{constructor(e){t(this,e),this.max=0,this.perPage=10,this.selectedPerPage=10,this.currentPage=1,this.kupPageChanged=s(this,"kupPageChanged",6),this.kupRowsPerPageChanged=s(this,"kupRowsPerPageChanged",6)}isPrevPageDisabled(){return 1==this.currentPage}isNextPageDisabled(){return this.currentPage*this.perPage>=this.max}onPrevPage(){this.isPrevPageDisabled()||this.kupPageChanged.emit({newPage:this.currentPage-1})}onNextPage(){this.isNextPageDisabled()||this.kupPageChanged.emit({newPage:this.currentPage+1})}onGoToPage({target:t}){this.kupPageChanged.emit({newPage:parseInt(t.value)})}onRowsPerPage({target:t}){this.kupRowsPerPageChanged.emit({newRowsPerPage:parseInt(t.value)})}getGoToPageOptions(t){const s=[];s.push(e("option",{value:"1",selected:1===this.currentPage},"1"));for(let i=2;i<=t;i++)s.push(e("option",{value:i,selected:this.currentPage===i},i));return s}getRowsPerPageOptions(){const t=[];if(this.currentPage!=this.max){let s=this.perPage;if(0===s)return t;for(;s<this.max;)t.push(e("option",{value:s,selected:s===this.selectedPerPage},s)),s*=2;t.push(e("option",{value:this.max,selected:this.max===this.perPage},this.max))}else t.push(e("option",{value:this.perPage,selected:!0},this.perPage));return t}render(){let t="mdi mdi-chevron-left";this.isPrevPageDisabled()&&(t+=" disabled");let s="mdi mdi-chevron-right";this.isNextPageDisabled()&&(s+=" disabled");const i=Math.ceil(this.max/this.selectedPerPage),r=this.getGoToPageOptions(i),a=this.getRowsPerPageOptions();return e("div",{id:"paginator"},e("div",{class:"align-left"},"Pagina",e("span",{class:"prev-page"},e("icon",{className:t,onclick:()=>this.onPrevPage()})),e("select",{onChange:t=>this.onGoToPage(t)},r),e("span",{class:"next-page"},e("icon",{className:s,onclick:()=>this.onNextPage()})),"Di ",i),e("div",{class:"align-right"},e("span",{class:"nextPageGroup"},"Numero risultati: ",this.max),e("slot",{name:"more-results"}),"Mostra",e("select",{onChange:t=>this.onRowsPerPage(t)},a),"righe per pagina"))}static get style(){return"\@import url(https://cdn.materialdesignicons.com/3.6.95/css/materialdesignicons.min.css);:host{--int_text-color:var(--kup-paginator_text-color,$mainTextColor);--int_font-size:var(--kup-paginator_font-size,1rem)}#paginator{color:var(--int_text-color);margin:.5rem 0;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-pack:justify;justify-content:space-between;font-size:var(--int_font-size)}#paginator icon{cursor:pointer;opacity:1;-webkit-transition:opacity .1s ease-in-out;transition:opacity .1s ease-in-out}#paginator icon:hover:not(.disabled){opacity:.75}#paginator icon.disabled{cursor:default;opacity:.3}#paginator .nextPageGroup,#paginator select{margin:0 .5rem}#paginator .next-page,#paginator .prev-page{margin:0 .25rem}#paginator .nextPageGroup{padding-right:1.5rem}"}}export{h as kup_graphic_cell,n as kup_paginator};