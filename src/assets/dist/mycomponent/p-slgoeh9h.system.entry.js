System.register(["./p-a690b875.system.js"],function(t){"use strict";var r,i;return{setters:[function(t){r=t.r;i=t.h}],execute:function(){function e(t){var r=t.indexOf("R");var i=t.indexOf("G");var e=t.indexOf("B");if(r<0||i<0||e<0){return}var a=t.substring(r+1,r+4);var n=t.substring(i+1,i+4);var o=t.substring(e+1,e+4);try{return new s(parseInt(a),parseInt(n),parseInt(o))}catch(t){console.error(t)}return null}var a=function(){function t(){this.width=100;this.height=100;this.color=null;this.shape="bar"}t.prototype.init=function(t){var r=this;t.forEach(function(t){if(t.toUpperCase().startsWith("HEIGHT;")){r.initHeight(t)}else if(t.toUpperCase().startsWith("SHAPE;")){r.initShape(t)}else if(t.toUpperCase().startsWith("BCOLOR;"));else{r.initColor(t)}})};t.prototype.initColor=function(t){if(t.length>11&&this.isValidColor(t)){this.color=e(t.substring(0,12));try{this.width=parseFloat(t.substring(13).replace(",","."))}catch(t){console.error(t)}}else if(t.startsWith("*NONE")){try{this.width=parseFloat(t.substring(6).replace(",","."))}catch(t){console.error(t)}}};t.prototype.isTrasparent=function(){return this.color===null};t.prototype.initHeight=function(t){if(t){var r=t.substring("HEIGHT;".length).replace(",",".");try{this.height=parseFloat(r)}catch(t){console.error(t)}}};t.prototype.initShape=function(t){t=t.substring("SHAPE;".length);var r=t.indexOf(";");var i=t;if(r>-1){i=t.substring(0,r);try{this.width=parseFloat(t.substring(r+1).replace(",","."))}catch(t){console.error(t)}}switch(i.toLocaleLowerCase()){case"circle":this.shape="circle";break;case"tril":this.shape="tril";break;case"trir":this.shape="trir";break}};t.prototype.isValidColor=function(t){if(!t){return false}t=t.trim();var r=[];var i=false;var e=null;var a=t.indexOf("R");if(a>-1){e=t.substring(a+1,a+4);r[0]=parseInt(e);if(isNaN(r[0])){i=true}}a=t.indexOf("G");if(a>-1){e=t.substring(a+1,a+4);r[1]=parseInt(e);if(isNaN(r[1])){i=true}}a=t.indexOf("B");if(a>-1){e=t.substring(a+1,a+4);r[2]=parseInt(e);if(isNaN(r[2])){i=true}}if(i){var s=t.indexOf("R");var n=t.indexOf("G");var o=t.indexOf("B");e=t.substring(s+1,n);r[0]=parseInt(e);if(isNaN(r[0])){i=true}e=t.substring(n+1,o);r[1]=parseInt(e);if(isNaN(r[1])){i=true}e=t.substring(o+1);r[2]=parseInt(e);if(isNaN(r[2])){i=true}if(i){return false}}if(r[0]<0||r[0]>255||r[1]<0||r[1]>255||r[2]<0||r[2]>255){return false}return true};t.prototype.getHeight=function(){return this.height};t.prototype.getWidth=function(){return this.width};t.prototype.getShape=function(){return this.shape};t.prototype.getColor=function(){return this.color};return t}();var s=function(){function t(t,r,i){this.r=t;this.g=r;this.b=i}t.prototype.toString=function(){return"rgb("+this.r+","+this.g+","+this.b+")"};return t}();var n=function(){function t(t){r(this,t);this.height=30;this.width=300;this.graphic_element_marker_splitter="\\\\";this.graphic_element_splitter="\\\\AND\\\\";this.background_color="BCOLOR;R255G000B000";this.default_color=new s(0,0,0)}t.prototype.onValueChange=function(){this.draw()};t.prototype.componentDidLoad=function(){this.draw()};t.prototype.draw=function(){if(!this.value){return}if(this.canvas.getContext){this.ctx=this.canvas.getContext("2d");this.drawGraphicCell()}};t.prototype.drawGraphicCell=function(){var t=this;var r=this.value.split(this.graphic_element_splitter);r.forEach(function(r,i){var s="SHAPE;BAR";var n=t.background_color;var o="HEIGHT;100";var h=r.split(t.graphic_element_marker_splitter);var c=[];var p=[];h.forEach(function(r){if(t.isShapeMarker(r)){s=r}else if(t.isBgColorMarker(r)){n=r}else if(t.isHeightMarker(r)){o=r}else if(t.isDecoratorMarker(r)){p.push(r)}else{c.push(r)}});var l=c.map(function(t){var r=new a;r.init([s,n,o,t]);return r});if(i===0&&n!==t.background_color){var u=e(n.substring("BCOLOR;".length));t.drawRect(0,0,t.canvas.width,t.canvas.height,u)}var f=0;l.forEach(function(r){switch(r.getShape()){case"circle":f=t.getNewStarXFromCircle(f,r);break;case"tril":f=t.getNewStarXFromTril(f,r);break;case"trir":f=t.getNewStarXFromTrir(f,r);break;default:f=t.getNewStarXFromBar(f,r);break}});p.forEach(function(r){if(r.startsWith("SEP")||r.startsWith("DIV")){t.drawSeparator(r)}else if(r.startsWith("ARW")){t.drawArrow(r)}else if(r.startsWith("GRID")){t.drawGrid(r)}})})};t.prototype.isShapeMarker=function(t){return t&&t.toUpperCase().startsWith("SHAPE;")};t.prototype.isBgColorMarker=function(t){return t&&t.toUpperCase().startsWith("BCOLOR;")};t.prototype.isHeightMarker=function(t){return t&&t.toUpperCase().startsWith("HEIGHT;")};t.prototype.isDecoratorMarker=function(t){return t&&(t.toUpperCase().startsWith("SEP;")||t.toUpperCase().startsWith("DIV;")||t.toUpperCase().startsWith("ARW;")||t.toUpperCase().startsWith("GRID;"))};t.prototype.getDim=function(t,r){return Math.floor(t/100*r)};t.prototype.getNewStarXFromBar=function(t,r){var i=this.getDim(this.canvas.width,r.getWidth());var e=this.getDim(this.canvas.height,r.getHeight());var a=this.canvas.height-e;if(!r.isTrasparent()){this.drawRect(t,a,i,e,r.getColor())}return i};t.prototype.getNewStarXFromCircle=function(t,r){var i=this.getDim(this.canvas.width,r.getWidth());var e=(t+i)/2;if(!r.isTrasparent()){this.drawArc(e,this.canvas.height/2,r.getColor())}return i};t.prototype.getNewStarXFromTril=function(t,r){var i=this.getDim(this.canvas.width,r.getWidth());if(!r.isTrasparent()){this.drawTri(i,0,t,this.canvas.height/2,r.getColor())}return i};t.prototype.getNewStarXFromTrir=function(t,r){var i=this.getDim(this.canvas.width,r.getWidth());if(!r.isTrasparent()){this.drawTri(t,0,i,this.canvas.height/2,r.getColor())}return i};t.prototype.drawArc=function(t,r,i){this.ctx.fillStyle=i.toString();this.ctx.beginPath();this.ctx.arc(t,r,r,0,2*Math.PI,true);this.ctx.fill()};t.prototype.drawRect=function(t,r,i,e,a){this.ctx.fillStyle=a.toString();this.ctx.fillRect(t,r,i,e)};t.prototype.drawTri=function(t,r,i,e,a){this.ctx.fillStyle=a.toString();this.ctx.beginPath();this.ctx.moveTo(t,r);this.ctx.lineTo(i,e);this.ctx.lineTo(t,this.canvas.height);this.ctx.fill()};t.prototype.drawArrow=function(t){var r=t.substring("ARW;".length);if(r.indexOf(",")>-1){r=r.replace(",",".")}this.ctx.fillStyle=this.default_color.toString();var i=this.getDim(this.canvas.width,parseFloat(r));var e=this.canvas.height;var a=Math.floor(e/3);var s=a/2;this.ctx.beginPath();this.ctx.moveTo(i,0);this.ctx.lineTo(i-a,e/2);this.ctx.lineTo(i-s,e/2);this.ctx.lineTo(i-s,e);this.ctx.lineTo(i+s,e);this.ctx.lineTo(i+s,e/2);this.ctx.lineTo(i+a,e/2);this.ctx.fill()};t.prototype.drawGrid=function(t){var r=t.substring("GRID;".length);if(r.indexOf(",")>-1){r=r.replace(",",".")}var i=parseInt(r);var e=this.canvas.width/i;var a=this.canvas.height/5;var s=this.canvas.height-a;var n=1;for(var o=e;o<this.canvas.width;o=o+e){this.drawRect(o,s,n,a,this.default_color)}};t.prototype.drawSeparator=function(t){var r=t.substring("SEP;".length).split(";");var i="R000G000B000";var a=2;var s=r[0];if(r.length>1){i=r[1]}if(r.length>2){a=parseInt(r[2])}if(s.indexOf(",")>-1){s=s.replace(",",".")}var n=this.getDim(this.canvas.width,parseFloat(s));this.drawRect(n,0,a,this.canvas.height,e(i))};t.prototype.render=function(){var t=this;return i("canvas",{ref:function(r){return t.canvas=r},height:this.height,width:this.width},this.value)};Object.defineProperty(t,"watchers",{get:function(){return{value:["onValueChange"]}},enumerable:true,configurable:true});return t}();t("kup_graphic_cell",n)}}});